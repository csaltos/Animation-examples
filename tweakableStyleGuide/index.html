<!doctype html>
<html>
<head>
    <title>Web Animations examples</title>
    <meta charset="utf-8">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: helvetica;
        }
        
        .sliderControl {
            
        }

        button {
            border: 1px solid black;
            margin-bottom: 20px;
        }

        article {
            text-align: center;
            width: 20vw;
            border: 2px solid #4165AD;
            box-shadow: 3px 3px 3px 2px #ccc;
        }

        article label {
            font-size: 0.8em;
        }
    </style>

    <script>

        // Slider Control Component - range slider with a display of current value.  
        function SliderControl(config, onValueChange) {
            var controlName = config.controlName || 'Value';
            var container = document.createElement('div'); 
            container.className = 'sliderControl';

            // Create label to display value of slider
            var label = document.createElement('label');
            var updateLabel = (val) => {
                label.textContent = config.labelText(val);
            };


            // Create range slider 
            var rangeSlider = document.createElement('input');
            rangeSlider.setAttribute('type', 'range');
            rangeSlider.setAttribute('min', config.min || 0);
            rangeSlider.setAttribute('max', config.max || 100);
            rangeSlider.setAttribute('step', config.step || 1);
            rangeSlider.setAttribute('value', config.initial || 0);
            rangeSlider.addEventListener('change', (evt) => {
                updateLabel(rangeSlider.value);
                onValueChange(rangeSlider.value);
            });

            updateLabel(rangeSlider.value);

          
            container.appendChild(label);
            container.appendChild(document.createElement('br'));
            container.appendChild(rangeSlider);

            return container;
        }

        window.addEventListener('load', function() {
            var el = document.getElementById('container');


            initBtnControls(); // Configure and display button tweakable controls
        });

        function initBtnControls() {
            var btnControls = document.getElementById('btnControls');
            
            var btn = document.getElementById('btnComponent');

            // btn animation config vars
            var duration = 2500;
            var fromColor = '#FAFAFA',
                toColor = '#4165AD';

            btn.style.backgroundColor = fromColor;

            var playAnimation = (animationDesc) => { // Called when a variable is changed
                // Stop all current animations
                if (btn.getAnimations) {
                    btn.getAnimations().map((anim) => anim.finish());
                }

                // Play the animation with the newly specified duration
                btn.animate([
                    {backgroundColor: fromColor}, 
                    {backgroundColor: toColor},
                    {backgroundColor: fromColor}
                ], duration);
            };

            // Create slider for the animation duration
            var durationSlider = new SliderControl({
                min: 0.05,
                max: 2,
                step: 0.05,
                initial: 1,
                labelText: (val) => 'Duration: ' + val + 's'
            }, (newDuration) => {
                duration = newDuration * 1000;
                playAnimation(); 
            });

            btnControls.appendChild(durationSlider);

            var btnFromColor = document.getElementById('btnFromColor'),
                btnToColor = document.getElementById('btnToColor');
            
            btnFromColor.value = fromColor;
            btnToColor.value = toColor;

            btnFromColor.addEventListener('change', () => {
                fromColor = btnFromColor.value;
                btn.style.backgroundColor = fromColor;
                playAnimation();
            });

            btnToColor.addEventListener('change', () => {
                toColor = btnToColor.value;
                playAnimation();
            });
        }
    </script>
</head>
<body>
    <div id="container">

        <article id="btnControls">
            <h3>Button Suggest Action Config</h3>
            <p>Use this animation to suggest a button action to the user by drawing attention to it.</p>
            <button id="btnComponent">Action</button>
            <br />
            <label for="btnColorFrom">Default Colour</label><input type="color" id="btnFromColor"/> <br />
            <label for="btnColorTo">Suggest Colour</label><input type="color" id="btnToColor" />
        </article>

    </div>
</body>
</html>
